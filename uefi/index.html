<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>UEFI | Gridea</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="http://huts1234.github.io/favicon.ico?v=1764722356065">
<link rel="stylesheet" href="http://huts1234.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="UEFI（统一可扩展固件接口）深度解析

一、UEFI 核心概念
UEFI（Unified Extensible Firmware Interface） 是替代传统 BIOS 的现代固件标准，由 Intel 于 2005 年提出并成为行业规..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="http://huts1234.github.io">
        <img src="http://huts1234.github.io/images/avatar.png?v=1764722356065" class="site-logo">
        <h1 class="site-title">Gridea</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      温故而知新
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="http://huts1234.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">UEFI</h2>
            <div class="post-date">2025-11-28</div>
            
            <div class="post-content" v-pre>
              <h1 id="uefi统一可扩展固件接口深度解析">UEFI（统一可扩展固件接口）深度解析</h1>
<hr>
<h2 id="一-uefi-核心概念">一、UEFI 核心概念</h2>
<p><strong>UEFI（Unified Extensible Firmware Interface）</strong> 是替代传统 BIOS 的现代固件标准，由 Intel 于 2005 年提出并成为行业规范。其核心改进包括：</p>
<table>
<thead>
<tr>
<th><strong>对比维度</strong></th>
<th><strong>传统 BIOS</strong></th>
<th><strong>UEFI</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>启动模式</td>
<td>仅支持 Legacy（CSM）</td>
<td>支持 UEFI 和 Legacy 双模式</td>
</tr>
<tr>
<td>硬盘支持</td>
<td>MBR 分区表（最大 2TB）</td>
<td>GPT 分区表（最大 9.4ZB）</td>
</tr>
<tr>
<td>图形界面</td>
<td>文本界面（16色）</td>
<td>图形化 GUI（支持鼠标操作）</td>
</tr>
<tr>
<td>启动速度</td>
<td>慢（需初始化所有硬件）</td>
<td>快（并行初始化 + 优化驱动加载）</td>
</tr>
<tr>
<td>安全机制</td>
<td>无</td>
<td>Secure Boot（阻止未签名代码运行）</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="二-uefi-关键功能与配置">二、UEFI 关键功能与配置</h2>
<h3 id="1-进入-uefi-设置的方法">1. 进入 UEFI 设置的方法</h3>
<table>
<thead>
<tr>
<th><strong>操作系统</strong></th>
<th><strong>操作步骤</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows 10/11</td>
<td>设置 → 更新与安全 → 恢复 → 高级启动 → 立即重新启动 → 疑难解答 → UEFI 固件设置</td>
</tr>
<tr>
<td>Linux（Systemd）</td>
<td>终端执行 <code>systemctl reboot --firmware-setup</code></td>
</tr>
<tr>
<td>物理按键</td>
<td>开机时按 <strong>Del/F2/F10/Esc</strong>（不同品牌按键不同，如华硕按 Del，戴尔按 F2）</td>
</tr>
</tbody>
</table>
<h3 id="2-secure-boot-安全启动">2. Secure Boot 安全启动</h3>
<ul>
<li><strong>工作原理</strong>：验证 EFI 可执行文件（如 <code>grubx64.efi</code>）的数字签名，阻止恶意引导程序加载</li>
<li><strong>兼容性问题</strong>：
<ul>
<li>安装 Linux 需选择支持 Secure Boot 的发行版（如 Ubuntu）或手动导入签名密钥</li>
<li>双系统用户可能需要禁用 Secure Boot 以加载非 Windows 系统</li>
</ul>
</li>
</ul>
<h3 id="3-启动模式选择">3. 启动模式选择</h3>
<table>
<thead>
<tr>
<th><strong>模式</strong></th>
<th><strong>适用场景</strong></th>
<th><strong>配置方法</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>UEFI 原生模式</td>
<td>新设备安装 Windows 10/11 或 Linux</td>
<td>禁用 CSM（兼容支持模块）</td>
</tr>
<tr>
<td>Legacy（CSM）</td>
<td>旧设备运行 DOS 或传统操作系统</td>
<td>启用 CSM，设置启动设备为 Legacy 优先</td>
</tr>
<tr>
<td>UEFI + Legacy 混合</td>
<td>新旧设备兼容</td>
<td>同时开启 UEFI 和 CSM，根据启动介质自动选择</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="三-uefi-与硬盘分区">三、UEFI 与硬盘分区</h2>
<h3 id="1-gpt-vs-mbr-分区表">1. GPT vs MBR 分区表</h3>
<table>
<thead>
<tr>
<th><strong>特性</strong></th>
<th><strong>MBR</strong></th>
<th><strong>GPT（GUID 分区表）</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>最大硬盘容量</td>
<td>2TB</td>
<td>9.4ZB（理论无上限）</td>
</tr>
<tr>
<td>分区数量</td>
<td>4个主分区（或3主分区+1扩展分区）</td>
<td>128个主分区</td>
</tr>
<tr>
<td>兼容性</td>
<td>所有系统</td>
<td>需 UEFI 支持（Windows 仅支持 64位系统）</td>
</tr>
<tr>
<td>数据安全</td>
<td>无备份</td>
<td>分区表头双重备份 + CRC32 校验</td>
</tr>
</tbody>
</table>
<p><strong>转换方法</strong>：</p>
<pre><code class="language-bash"># 使用 gdisk 将 MBR 转为 GPT（数据会丢失！）
gdisk /dev/sda
x  # 专家模式
z  # 转换分区表
y  # 确认
</code></pre>
<h3 id="2-创建-uefi-系统分区esp">2. 创建 UEFI 系统分区（ESP）</h3>
<ul>
<li><strong>要求</strong>：
<ul>
<li>FAT32 格式（建议 300-500MB）</li>
<li>挂载点 <code>/boot/efi</code>（Linux）或隐藏分区（Windows）</li>
</ul>
</li>
<li><strong>Linux 安装示例</strong>：<pre><code class="language-bash">mkfs.fat -F32 /dev/sda1  # 格式化 ESP 分区
mount /dev/sda1 /boot/efi
</code></pre>
</li>
</ul>
<hr>
<h2 id="四-uefi-故障排查">四、UEFI 故障排查</h2>
<h3 id="1-常见启动错误">1. 常见启动错误</h3>
<table>
<thead>
<tr>
<th><strong>错误提示</strong></th>
<th><strong>原因</strong></th>
<th><strong>解决方案</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>No bootable device found</code></td>
<td>启动顺序错误或硬盘未识别</td>
<td>检查 BIOS 启动顺序，确认硬盘连接正常</td>
</tr>
<tr>
<td><code>Secure Boot Violation</code></td>
<td>加载了未签名的驱动或引导程序</td>
<td>禁用 Secure Boot 或导入自定义密钥</td>
</tr>
<tr>
<td><code>Invalid partition table</code></td>
<td>GPT/MBR 与启动模式不匹配</td>
<td>转换分区表或切换 Legacy/UEFI 模式</td>
</tr>
<tr>
<td><code>EFI stub: Load error</code></td>
<td>Linux 内核未启用 EFI stub 编译</td>
<td>重新编译内核或使用 GRUB2 作为引导加载程序</td>
</tr>
</tbody>
</table>
<h3 id="2-修复-uefi-引导windows">2. 修复 UEFI 引导（Windows）</h3>
<pre><code class="language-powershell"># 使用安装盘进入命令行
bootrec /fixboot      # 修复启动文件
bootrec /scanos       # 扫描已安装系统
bootrec /rebuildbcd   # 重建 BCD 存储
</code></pre>
<h3 id="3-修复-uefi-引导linux">3. 修复 UEFI 引导（Linux）</h3>
<pre><code class="language-bash"># 重新安装 GRUB
grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=GRUB
update-grub
</code></pre>
<hr>
<h2 id="五-uefi-固件更新">五、UEFI 固件更新</h2>
<h3 id="1-更新步骤">1. 更新步骤</h3>
<ol>
<li>官网下载对应型号的固件文件（通常为 <code>.cap</code> 或 <code>.bio</code> 格式）</li>
<li>将文件复制到 FAT32 格式的 U 盘根目录</li>
<li>进入 UEFI 设置界面选择 <code>Flash BIOS</code> 或 <code>EZ Flash</code> 工具</li>
<li>选择文件并确认更新（切勿断电）</li>
</ol>
<h3 id="2-风险提示">2. 风险提示</h3>
<ul>
<li><strong>验证文件完整性</strong>：通过 SHA256 校验和比对</li>
<li><strong>回退机制</strong>：部分厂商支持降级（如华硕 USB BIOS Flashback）</li>
<li><strong>紧急恢复</strong>：若更新失败，使用编程器重写 SPI 闪存芯片</li>
</ul>
<hr>
<h2 id="六-uefi-开发与扩展">六、UEFI 开发与扩展</h2>
<h3 id="1-uefi-应用开发">1. UEFI 应用开发</h3>
<ul>
<li><strong>工具链</strong>：EDK II（EFI Development Kit II）</li>
<li><strong>示例代码（Hello World）</strong>：<pre><code class="language-c">#include &lt;Uefi.h&gt;
EFI_STATUS EFIAPI UefiMain(EFI_HANDLE ImageHandle, EFI_SYSTEM_TABLE *SystemTable) {
  SystemTable-&gt;ConOut-&gt;OutputString(SystemTable-&gt;ConOut, L&quot;Hello UEFI World!&quot;);
  return EFI_SUCCESS;
}
</code></pre>
</li>
<li><strong>编译命令</strong>：<pre><code class="language-bash">build -a X64 -p MyApp/MyApp.dsc -t GCC5
</code></pre>
</li>
</ul>
<h3 id="2-安全研究">2. 安全研究</h3>
<ul>
<li><strong>UEFI 漏洞案例</strong>：
<ul>
<li><strong>ThunderSpy</strong>（CVE-2020-2593）：通过物理接口注入恶意固件</li>
<li><strong>LogoFAIL</strong>（2023年）：利用启动 Logo 图片触发缓冲区溢出</li>
</ul>
</li>
</ul>
<hr>
<p>通过深入理解 UEFI 架构，用户可优化系统启动流程、增强安全防护，并为高级开发与维护奠定基础。建议定期检查固件更新并备份关键配置。 🔧🔒</p>

            </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="http://huts1234.github.io/bootloader/">
                  <h3 class="post-title">
                    BootLoader
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
</html>
